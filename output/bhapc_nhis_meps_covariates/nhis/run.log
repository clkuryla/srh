
 ====================================================================== 
BHAPC COVARIATE ANALYSIS: NHIS
Started at: 2026-02-06 02:30:34 
====================================================================== 


Attaching package: ‘srvyr’

The following object is masked from ‘package:stats’:

    filter

Configuration:
  Cores: 8 
  Iterations: 6000 
  Subsample N: 1e+05 

--- STEP 1: LOADING NHIS DATA ---
  Raw rows: 2,827,707 
  After filtering (1997+): 1,690,366 
  After subsampling: 100,000 
           used  (Mb) gc trigger   (Mb)   max used   (Mb)
Ncells  3396609 181.4   12483348  666.7    7783128  415.7
Vcells 29840831 227.7 1157430119 8830.5 1277995545 9750.4

--- STEP 2: MISSINGNESS ---
 variable n_total n_valid n_missing pct_missing
      srh  100000  100000         0         0.0
      age  100000  100000         0         0.0
     year  100000  100000         0         0.0
       wt  100000  100000         0         0.0
   race_f  100000   99992         8         0.0
   educ_f  100000   97871      2129         2.1
    sex_f  100000  100000         0         0.0
       k6  100000   42293     57707        57.7

--- STEP 3: SAMPLES ---
  M1: 100000   M2: 97865   M3: 42293   M4: 42042 

--- STEP 4: BHAPC PREP ---
Preparing BHAPC data for NHIS
  Initial rows: 100,000
  Observed age range: 18 - 85
  NOTE: Survey age cap detected. Using max age = 85
  Using weight column: wt
  Final rows: 100,000
  Years: 1999-2024
  Periods: 1995, 1999, 2003, 2007, 2011, 2015, 2019, 2023
  Age groups: 15
  Cohorts: 25
  Mean SRH: 3.71
Preparing BHAPC data for NHIS
  Initial rows: 97,865
  Observed age range: 18 - 85
  NOTE: Survey age cap detected. Using max age = 85
  Using weight column: wt
  Final rows: 97,865
  Years: 1999-2024
  Periods: 1995, 1999, 2003, 2007, 2011, 2015, 2019, 2023
  Age groups: 15
  Cohorts: 25
  Mean SRH: 3.72
Preparing BHAPC data for NHIS
  Initial rows: 42,293
  Observed age range: 18 - 85
  NOTE: Survey age cap detected. Using max age = 85
  Using weight column: wt
  Final rows: 42,293
  Years: 1999-2024
  Periods: 1995, 1999, 2003, 2007, 2011, 2015, 2019, 2023
  Age groups: 15
  Cohorts: 25
  Mean SRH: 3.68
Preparing BHAPC data for NHIS
  Initial rows: 42,042
  Observed age range: 18 - 85
  NOTE: Survey age cap detected. Using max age = 85
  Using weight column: wt
  Final rows: 42,042
  Years: 1999-2024
  Periods: 1995, 1999, 2003, 2007, 2011, 2015, 2019, 2023
  Age groups: 15
  Cohorts: 25
  Mean SRH: 3.69

--- STEP 5: FITTING MODELS ---

  Fitting m1 - N: 100000 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.062032 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 620.32 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 0.046775 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 467.75 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 0.05876 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 587.6 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 0.063164 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 631.64 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 2: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 1: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 3: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 4: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 1: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 2: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 1: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 2: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 1: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 2: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 3: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 4: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 1: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 3: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 2: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 4: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 1: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 1: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 2: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 2: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 3: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 4: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 2: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 3: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 3: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 1: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 4: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 4: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 2: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 4: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 2: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 1: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 4: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 2: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 3: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 4: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 2: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 20271.1 seconds (Warm-up)
Chain 2:                7527.23 seconds (Sampling)
Chain 2:                27798.3 seconds (Total)
Chain 2: 
Chain 1: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 4: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 3: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 4: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 23440.7 seconds (Warm-up)
Chain 4:                6697.62 seconds (Sampling)
Chain 4:                30138.3 seconds (Total)
Chain 4: 
Chain 1: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 3: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 1: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 19629.8 seconds (Warm-up)
Chain 1:                13594.3 seconds (Sampling)
Chain 1:                33224.1 seconds (Total)
Chain 1: 
Chain 3: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 3: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 23367.3 seconds (Warm-up)
Chain 3:                12838.3 seconds (Sampling)
Chain 3:                36205.6 seconds (Total)
Chain 3: 
    Completed in 603.5 minutes

  Fitting m2 - N: 97865 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.031482 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 314.82 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 0.031298 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 312.98 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 0.032228 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 322.28 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 1: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 4: 
Chain 4: Gradient evaluation took 0.034921 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 349.21 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 2: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 3: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 4: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 2: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 2: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 1: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 2: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 4: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 4: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 2: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 1: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 4: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 1: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 2: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 2: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 4: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 1: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 1: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 4: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 4: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 2: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 1: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 4: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 1: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 2: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 4: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 1: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 1: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 4: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 2: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 1: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 11626.8 seconds (Warm-up)
Chain 1:                7877.17 seconds (Sampling)
Chain 1:                19504 seconds (Total)
Chain 1: 
Chain 4: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 4: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 12914.4 seconds (Warm-up)
Chain 4:                8427.64 seconds (Sampling)
Chain 4:                21342 seconds (Total)
Chain 4: 
Chain 2: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 3: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 2: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 9986.46 seconds (Warm-up)
Chain 2:                14082.4 seconds (Sampling)
Chain 2:                24068.8 seconds (Total)
Chain 2: 
Chain 3: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 3: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 3: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 3: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 3: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 3: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 3: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 3: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 3: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 3: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 29004.7 seconds (Warm-up)
Chain 3:                5317.23 seconds (Sampling)
Chain 3:                34321.9 seconds (Total)
Chain 3: 
    Completed in 572.1 minutes

  Fitting m3 - N: 42293 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.012258 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 122.58 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 1: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 2: 
Chain 2: Gradient evaluation took 0.012114 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 121.14 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 0.011831 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 118.31 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 2: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 3: Iteration:    1 / 6000 [  0%]  (Warmup)

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 0.011798 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 117.98 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 2: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 1: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 2: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 1: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 2: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 1: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 4: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 2: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 1: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 4: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 2: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 2: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 4: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 1: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 1: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 4: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 4: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 2: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 1: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 4: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 2: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 4: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 1: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 2: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 4: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 1: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 2: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 4: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 4: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 2417.2 seconds (Warm-up)
Chain 4:                2009.06 seconds (Sampling)
Chain 4:                4426.26 seconds (Total)
Chain 4: 
Chain 2: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 2035.43 seconds (Warm-up)
Chain 2:                2418.11 seconds (Sampling)
Chain 2:                4453.55 seconds (Total)
Chain 2: 
Chain 1: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 1: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 2126.45 seconds (Warm-up)
Chain 1:                2959.66 seconds (Sampling)
Chain 1:                5086.11 seconds (Total)
Chain 1: 
Chain 3: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 3: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 3: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 3: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 3: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 3: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 3: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 3: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 3: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 3: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 3: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 6139.33 seconds (Warm-up)
Chain 3:                1193.67 seconds (Sampling)
Chain 3:                7333 seconds (Total)
Chain 3: 
    Completed in 122.3 minutes

  Fitting m4 - N: 42042 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.014784 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 147.84 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 0.013992 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 139.92 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 1: Iteration:    1 / 6000 [  0%]  (Warmup)

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 0.014137 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 141.37 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 2: Iteration:    1 / 6000 [  0%]  (Warmup)

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 0.014182 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 141.82 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 3: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 4: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 3: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 1: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 3: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 1: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 2: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 3: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 1: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 4: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 2: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 4: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 3: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 2: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 1: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 4: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 2: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 3: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 3: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 1: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 1: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 4: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 4: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 3: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 2: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 2: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 3: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 1: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 4: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 2: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 3: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 2: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 1: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 3: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 4: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 3: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 2725.22 seconds (Warm-up)
Chain 3:                1801.34 seconds (Sampling)
Chain 3:                4526.56 seconds (Total)
Chain 3: 
Chain 2: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 1: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 4: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 2: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 1: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 4: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 2: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 3119.56 seconds (Warm-up)
Chain 2:                2532.46 seconds (Sampling)
Chain 2:                5652.02 seconds (Total)
Chain 2: 
Chain 1: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 2880.97 seconds (Warm-up)
Chain 1:                3170.3 seconds (Sampling)
Chain 1:                6051.27 seconds (Total)
Chain 1: 
Chain 4: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 2986.14 seconds (Warm-up)
Chain 4:                3073.53 seconds (Sampling)
Chain 4:                6059.66 seconds (Total)
Chain 4: 
    Completed in 101.1 minutes

--- STEP 6: EXTRACTING RESULTS ---

Variance Comparison (%):
 component    M1_base   M2_demog       M3_k6     M4_full
    Cohort  0.5010864  0.2966319  0.06738425  0.07662488
    Period  0.1189248  0.6434862  0.22520989  0.68884357
  Residual 99.3799888 99.0598819 99.70740587 99.23453155

Convergence:
 model max_rhat min_neff converged
    M1 1.001568     1823      TRUE
    M2 1.003138     2030      TRUE
    M3 1.001663     2266      TRUE
    M4 1.002305     2505      TRUE

--- STEP 7: FIGURES ---
Warning messages:
1: There was 1 warning in `mutate()`.
ℹ In argument: `period = as.numeric(period)`.
Caused by warning:
! NAs introduced by coercion 
2: There was 1 warning in `mutate()`.
ℹ In argument: `cohort = as.numeric(cohort)`.
Caused by warning:
! NAs introduced by coercion 
Warning messages:
1: There was 1 warning in `mutate()`.
ℹ In argument: `period = as.numeric(period)`.
Caused by warning:
! NAs introduced by coercion 
2: There was 1 warning in `mutate()`.
ℹ In argument: `cohort = as.numeric(cohort)`.
Caused by warning:
! NAs introduced by coercion 
Warning messages:
1: There was 1 warning in `mutate()`.
ℹ In argument: `period = as.numeric(period)`.
Caused by warning:
! NAs introduced by coercion 
2: There was 1 warning in `mutate()`.
ℹ In argument: `cohort = as.numeric(cohort)`.
Caused by warning:
! NAs introduced by coercion 
Warning messages:
1: There was 1 warning in `mutate()`.
ℹ In argument: `period = as.numeric(period)`.
Caused by warning:
! NAs introduced by coercion 
2: There was 1 warning in `mutate()`.
ℹ In argument: `cohort = as.numeric(cohort)`.
Caused by warning:
! NAs introduced by coercion 
Warning messages:
1: Removed 4 rows containing missing values or values outside the scale range
(`geom_line()`). 
2: Removed 4 rows containing missing values or values outside the scale range
(`geom_point()`). 
Saved Figure 3 to: /home/ubuntu/projects/srh/srh-bhapc/output/bhapc_nhis_meps_covariates/nhis/figure3_m4.png
Warning messages:
1: There was 1 warning in `mutate()`.
ℹ In argument: `period = as.numeric(period)`.
Caused by warning:
! NAs introduced by coercion 
2: There was 1 warning in `mutate()`.
ℹ In argument: `cohort = as.numeric(cohort)`.
Caused by warning:
! NAs introduced by coercion 
3: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`). 
4: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`). 
  Figures saved

 ====================================================================== 
NHIS COMPLETE
Cohort variance: M1=0.50% -> M4=0.08% (85% reduction)
Finished at: 2026-02-07 01:52:08 
====================================================================== 
