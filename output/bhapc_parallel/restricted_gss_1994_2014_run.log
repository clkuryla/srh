
 ====================================================================== 
BHAPC GSS RESTRICTED (1994-2014)
Started at: 2026-02-05 20:48:44 
====================================================================== 

Year restriction: 1994 - 2014 
Iterations: 6000 
Cores: 10 

--- STEP 1: DATA LOADING & PREPARATION ---
  Original GSS N (all years): 57,627 
  Filtered N ( 1994 - 2014 ): 21,863 
  Year range: 1994 - 2014 
Preparing BHAPC data for GSS
  Initial rows: 21,863
  Observed age range: 18 - 89
  Using weight column: wt
  Final rows: 21,863
  Years: Inf-2014
  Periods: 1991, 1995, 1999, 2003, 2007, 2011
  Age groups: 15
  Cohorts: 23
  Mean SRH: 3
Warning message:
In min(df$year[df$year %in% as.numeric(unique(bhapc_df$period_4yr))],  :
  no non-missing arguments to min; returning Inf
  BHAPC N: 21,863 
  Periods: 1991, 1995, 1999, 2003, 2007, 2011 
  Cohorts: 23 

--- STEP 2: MAIN BHAPC MODEL ---
  Formula: srh ~ age + scale(age_squared) + lnWt + (1|period_4yr) + (1|cohort_4yr)
  iter = 6000 , adapt_delta = 0.998 
Fitting BHAPC model...
  Outcome: srh
  N observations: 21,863
  N periods: 6
  N cohorts: 23
  adapt_delta: 0.998
  iter: 6000
  chains: 4
  cores: 10
  No strata/PSU random effects (not available)
  Formula: srh ~ age + scale(age_squared) + lnWt + (1|period_4yr) + (1|cohort_4yr)

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.006223 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 62.23 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 0.006135 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 61.35 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 3: 
Chain 3: Gradient evaluation took 0.00624 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 62.4 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 4: 
Chain 4: Gradient evaluation took 0.006125 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 61.25 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 1: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 2: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 3: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 4: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 4: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 2: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 1: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 4: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 2: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 1: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 4: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 3: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 2: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 1: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 4: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 3: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 2: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 1: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 4: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 4: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 3: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 1: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 1: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 2: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 2: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 4: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 3: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 1: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 4: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 3: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 3: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 1: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 2: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 4: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 1: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 3: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 4: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 1: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 2: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 1: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 1039.51 seconds (Warm-up)
Chain 1:                643.542 seconds (Sampling)
Chain 1:                1683.05 seconds (Total)
Chain 1: 
Chain 4: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 938.436 seconds (Warm-up)
Chain 4:                754.987 seconds (Sampling)
Chain 4:                1693.42 seconds (Total)
Chain 4: 
Chain 3: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 2: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 3: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 2: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 3: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 2: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 1067.94 seconds (Warm-up)
Chain 2:                1342.04 seconds (Sampling)
Chain 2:                2409.98 seconds (Total)
Chain 2: 
Chain 3: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 1283.84 seconds (Warm-up)
Chain 3:                1146.53 seconds (Sampling)
Chain 3:                2430.36 seconds (Total)
Chain 3: 
  Model fitting completed in 40.6 minutes
  Model completed in 40.6 minutes

--- STEP 3: EXTRACTING RESULTS ---

  Variance Decomposition:
     cohort_4yr :  4e-04  ( 0.1 %)
     period_4yr :  0.0045  ( 0.7 %)
     Residual :  0.6535  ( 99.3 %)
     Total :  0.6584  ( 100 %)

  Diagnostics:
    Max Rhat: 1.001 
    Min n_eff: 2527 
    Converged: TRUE 
Saved Table 2 to: /home/ubuntu/projects/srh/srh-bhapc/output/bhapc_parallel/restricted_gss_1994_2014/table2_gss_restricted.csv

--- STEP 4: INTERACTION MODEL (AGE × PERIOD) ---
  Formula: srh ~ age_centered * period_4yr + lnWt + (1|cohort_4yr)

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.0029 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 29 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 0.002881 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 28.81 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 0.002787 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 27.87 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 0.00273 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 27.3 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 169.514 seconds (Warm-up)
Chain 4:                45.321 seconds (Sampling)
Chain 4:                214.835 seconds (Total)
Chain 4: 
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 296.558 seconds (Warm-up)
Chain 2:                41.848 seconds (Sampling)
Chain 2:                338.406 seconds (Total)
Chain 2: 
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 297.461 seconds (Warm-up)
Chain 1:                41.454 seconds (Sampling)
Chain 1:                338.915 seconds (Total)
Chain 1: 
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 355.076 seconds (Warm-up)
Chain 3:                41.748 seconds (Sampling)
Chain 3:                396.824 seconds (Total)
Chain 3: 
  Interaction model completed in 6.6 minutes

  Age×Period Interaction Summary:
  period    age_slope  interaction         ci_10        ci_90 significant
1   1991 -0.011216528 0.0000000000 -0.0126582661 -0.009766448         ref
2   1995 -0.010476556 0.0007399722 -0.0008528870  0.002378564            
3   1999 -0.010606748 0.0006097797 -0.0010350877  0.002255785            
4   2003 -0.009329793 0.0018867346  0.0001942814  0.003607100           *
5   2007 -0.008799619 0.0024169092  0.0005908330  0.004289030           *
6   2011 -0.007476826 0.0037397021  0.0018773474  0.005586832           *

--- STEP 5: GENERATING FIGURES ---
Computing survey-weighted means using: wt
Saved Figure 2 to: /home/ubuntu/projects/srh/srh-bhapc/output/bhapc_parallel/restricted_gss_1994_2014/figure2_gss_restricted.png
Saved Figure 3 to: /home/ubuntu/projects/srh/srh-bhapc/output/bhapc_parallel/restricted_gss_1994_2014/figure3_gss_restricted.png
Warning messages:
1: There was 1 warning in `mutate()`.
ℹ In argument: `period = as.numeric(period)`.
Caused by warning:
! NAs introduced by coercion 
2: There was 1 warning in `mutate()`.
ℹ In argument: `cohort = as.numeric(cohort)`.
Caused by warning:
! NAs introduced by coercion 
3: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`). 
4: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`). 
  Figures saved

--- COMPARISON WITH FULL GSS ---

  Variance % Comparison:
 Component Full GSS (1971-2024) Restricted GSS (1994-2014)
    Period            0.1396303                 0.68241422
    Cohort            2.3464204                 0.06180167
  Residual           97.5139492                99.25578411

 ====================================================================== 
COMPLETE: GSS RESTRICTED (1994-2014)
Total time: 47.3 minutes
Output directory: /home/ubuntu/projects/srh/srh-bhapc/output/bhapc_parallel/restricted_gss_1994_2014 
Finished at: 2026-02-05 21:36:07 
====================================================================== 
