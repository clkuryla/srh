
 ====================================================================== 
BHAPC GSS RESTRICTED (2004-2024)
Started at: 2026-02-05 20:48:43 
====================================================================== 

Year restriction: 2004 - 2024 
Iterations: 6000 
Cores: 10 

--- STEP 1: DATA LOADING & PREPARATION ---
  Original GSS N (all years): 57,627 
  Filtered N ( 2004 - 2024 ): 24,121 
  Year range: 2004 - 2024 
Preparing BHAPC data for GSS
  Initial rows: 24,121
  Observed age range: 18 - 89
  Using weight column: wt
  Final rows: 24,121
  Years: Inf-2024
  Periods: 2003, 2007, 2011, 2015, 2019, 2023
  Age groups: 15
  Cohorts: 23
  Mean SRH: 2.91
Warning message:
In min(df$year[df$year %in% as.numeric(unique(bhapc_df$period_4yr))],  :
  no non-missing arguments to min; returning Inf
  BHAPC N: 24,121 
  Periods: 2003, 2007, 2011, 2015, 2019, 2023 
  Cohorts: 23 

--- STEP 2: MAIN BHAPC MODEL ---
  Formula: srh ~ age + scale(age_squared) + lnWt + (1|period_4yr) + (1|cohort_4yr)
  iter = 6000 , adapt_delta = 0.998 
Fitting BHAPC model...
  Outcome: srh
  N observations: 24,121
  N periods: 6
  N cohorts: 23
  adapt_delta: 0.998
  iter: 6000
  chains: 4
  cores: 10
  No strata/PSU random effects (not available)
  Formula: srh ~ age + scale(age_squared) + lnWt + (1|period_4yr) + (1|cohort_4yr)

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.00516 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 51.6 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 0.005188 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 51.88 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 0.005118 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 51.18 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 0.006914 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 69.14 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 1: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 2: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 3: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 4: Iteration:    1 / 6000 [  0%]  (Warmup)
Chain 4: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 2: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 1: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 4: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 1: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 2: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 6000 [ 10%]  (Warmup)
Chain 4: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 1: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 2: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 3: Iteration: 1200 / 6000 [ 20%]  (Warmup)
Chain 4: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 2: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 1: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 3: Iteration: 1800 / 6000 [ 30%]  (Warmup)
Chain 2: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 2: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 4: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 4: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 1: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 1: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 3: Iteration: 2400 / 6000 [ 40%]  (Warmup)
Chain 2: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 4: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 1: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 2: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 3: Iteration: 3000 / 6000 [ 50%]  (Warmup)
Chain 3: Iteration: 3001 / 6000 [ 50%]  (Sampling)
Chain 4: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 2: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 4: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 3: Iteration: 3600 / 6000 [ 60%]  (Sampling)
Chain 1: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 2: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 4: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 4: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 1383.93 seconds (Warm-up)
Chain 4:                936.225 seconds (Sampling)
Chain 4:                2320.15 seconds (Total)
Chain 4: 
Chain 2: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 1378.29 seconds (Warm-up)
Chain 2:                945.17 seconds (Sampling)
Chain 2:                2323.46 seconds (Total)
Chain 2: 
Chain 3: Iteration: 4200 / 6000 [ 70%]  (Sampling)
Chain 1: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 3: Iteration: 4800 / 6000 [ 80%]  (Sampling)
Chain 1: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 3: Iteration: 5400 / 6000 [ 90%]  (Sampling)
Chain 1: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 1434.08 seconds (Warm-up)
Chain 1:                1625.02 seconds (Sampling)
Chain 1:                3059.1 seconds (Total)
Chain 1: 
Chain 3: Iteration: 6000 / 6000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 1759.35 seconds (Warm-up)
Chain 3:                1565.87 seconds (Sampling)
Chain 3:                3325.21 seconds (Total)
Chain 3: 
  Model fitting completed in 55.5 minutes
  Model completed in 55.5 minutes

--- STEP 3: EXTRACTING RESULTS ---

  Variance Decomposition:
     cohort_4yr :  0.01  ( 1.5 %)
     period_4yr :  0.0028  ( 0.4 %)
     Residual :  0.6337  ( 98 %)
     Total :  0.6465  ( 100 %)

  Diagnostics:
    Max Rhat: 1.002 
    Min n_eff: 2022 
    Converged: TRUE 
Saved Table 2 to: /home/ubuntu/projects/srh/srh-bhapc/output/bhapc_parallel/restricted_gss_2004_2024/table2_gss_restricted.csv

--- STEP 4: INTERACTION MODEL (AGE × PERIOD) ---
  Formula: srh ~ age_centered * period_4yr + lnWt + (1|cohort_4yr)

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.006785 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 67.85 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 0.006657 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 66.57 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 0.006687 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 66.87 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 0.00663 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 66.3 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 296.146 seconds (Warm-up)
Chain 4:                34.094 seconds (Sampling)
Chain 4:                330.24 seconds (Total)
Chain 4: 
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 364.522 seconds (Warm-up)
Chain 3:                38.148 seconds (Sampling)
Chain 3:                402.67 seconds (Total)
Chain 3: 
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 382.354 seconds (Warm-up)
Chain 1:                52.51 seconds (Sampling)
Chain 1:                434.864 seconds (Total)
Chain 1: 
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 455.163 seconds (Warm-up)
Chain 2:                49.674 seconds (Sampling)
Chain 2:                504.837 seconds (Total)
Chain 2: 
  Interaction model completed in 8.4 minutes

  Age×Period Interaction Summary:
  period    age_slope  interaction         ci_10        ci_90 significant
1   2003 -0.009505073 0.0000000000 -0.0104436292 -0.008563020         ref
2   2007 -0.008884664 0.0006204085 -0.0008566816  0.002071030            
3   2011 -0.007577392 0.0019276809  0.0005643745  0.003307355           *
4   2015 -0.004084681 0.0054203912  0.0041332052  0.006733293           *
5   2019 -0.002801448 0.0067036240  0.0055368307  0.007841886           *
6   2023 -0.003107644 0.0063974283  0.0050254490  0.007773056           *

--- STEP 5: GENERATING FIGURES ---
Computing survey-weighted means using: wt
Saved Figure 2 to: /home/ubuntu/projects/srh/srh-bhapc/output/bhapc_parallel/restricted_gss_2004_2024/figure2_gss_restricted.png
Saved Figure 3 to: /home/ubuntu/projects/srh/srh-bhapc/output/bhapc_parallel/restricted_gss_2004_2024/figure3_gss_restricted.png
Warning messages:
1: There was 1 warning in `mutate()`.
ℹ In argument: `period = as.numeric(period)`.
Caused by warning:
! NAs introduced by coercion 
2: There was 1 warning in `mutate()`.
ℹ In argument: `cohort = as.numeric(cohort)`.
Caused by warning:
! NAs introduced by coercion 
3: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`). 
4: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`). 
  Figures saved

--- COMPARISON WITH FULL GSS ---

  Variance % Comparison:
 Component Full GSS (1971-2024) Restricted GSS (2004-2024)
    Period            0.1396303                  0.4335686
    Cohort            2.3464204                  1.5422549
  Residual           97.5139492                 98.0241765

 ====================================================================== 
COMPLETE: GSS RESTRICTED (2004-2024)
Total time: 64 minutes
Output directory: /home/ubuntu/projects/srh/srh-bhapc/output/bhapc_parallel/restricted_gss_2004_2024 
Finished at: 2026-02-05 21:52:50 
====================================================================== 
