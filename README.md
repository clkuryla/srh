# SRH
Self Rated Health Analysis on 6 Datasets


# Overview

This repository contains code to reproduce the analyses and figures for:

## Self Rated Health

Due to data use agreements and file size constraints, raw data are not included in this repository.

The project is structured to separate:
  - raw data storage
  - data processing
  - analysis
  - reporting
This avoids data duplication, reduces clutter, and supports reproducibility.

Data access & data depot
Raw data

This project uses the following datasets:

[Dataset 1] (e.g., MEPS via IPUMS)

[Dataset 2]

[Dataset 3]

Users must obtain these datasets directly from the original sources.

Data depot (external storage)

Raw data are stored outside the repository in a local data depot.

Example structure:

data_depot/
  DATASET_1/
  DATASET_2/
  DATASET_3/
  _derived/
    project_name/


This prevents duplication of large files and allows multiple projects to reference the same raw data. See R/paths.R for path helper. 

One-time setup
1. Set data depot location

Set an environment variable pointing to your local data depot:

SRH_DATA=/path/to/data_depot


This is done in your .Renviron file (not tracked by git).

Restart R/RStudio after setting this.

2. Install required packages

Install required R packages as needed (see scripts for details).

Repository structure
project/
  R/            # reusable functions and path helpers
  data_wrangling_code/      # scripts: raw data -> analytic datasets
  analysis/       # scripts for modeling and intermediate analyses
                  # also: INVARIANTS.md, DECISIONS.md, RUNBOOK.md 
  reports/        # Finalized quarto/rmd
  outputs/        # generated R Markdown/Quarto files, figures and tables
  sandbox/        # exploratory / in-progress code
  notes/          

Folder roles
R/
  Reusable functions and helper utilities (including path management).

data_wrangling_code/

  Scripts that:
  - read raw data from the data depot
  - perform cleaning and recoding
  - save analytic datasets as .rds files (to the data depot)

analysis/

  Scripts that load analytic datasets and run models or computations.
  Markdowns that provide additional information and guide copilot

reports/

  R Markdown/Quarto files that generate figures, tables, and narrative.
  These files load precomputed analytic data and do not perform heavy wrangling.

sandbox/

  Exploratory or experimental code.
  Files here are not required for reproducibility.

Path handling (R/paths.R)

  All scripts use a small helper file to manage paths.

  Key functions:
  
  data_root() — returns the data depot root
  depot_path(...) — paths to raw data
  derived_path(...) — paths to analytic datasets
  ensure_dirs() — creates required output directories
  
  This ensures:
  - no hard-coded machine-specific paths
  - no accidental storage of data inside the repo
  - portability across machines after setup

Reproducing the analysis

  After completing setup:

  1.  Run data processing scripts:
      data_wrangling_code/01_process_dataset1.R, etc

  2. Run analysis scripts (if applicable):

    analysis/01_models.R, etc
    analysis/02_sensitivity.R, etc

  3. Knit the report:

    reports/master.Rmd, etc


  This will reproduce the main figures and tables.

Reproducibility notes

    Raw data are not included due to size and access restrictions.
    
    Analytic datasets are generated by scripts in data-raw/.
    
    Files in sandbox/ are exploratory and not part of the reproducible pipeline.
    
    This repository supports procedural reproducibility: a knowledgeable analyst can reproduce results by following documented steps.

Philosophy

This repository prioritizes:
  clarity over cleverness
  explicit data flow
  separation of exploration and production
  scientific reproducibility without unnecessary software complexity

This structure is intended to scale across projects and datasets while remaining manageable for research workflows.